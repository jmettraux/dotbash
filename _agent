
# thanks to
# https://yashagarwal.in/posts/2017/12/setting-up-ssh-agent-in-i3/


ssh-add -l > /dev/null 2>&1; if [ $? != 0 ]; then

  if [ -f ~/.ssh/agent.env ]; then
    . ~/.ssh/agent.env > /dev/null
    if ! kill -0 $SSH_AGENT_PID > /dev/null 2>&1; then
      echo "Stale agent file found. Spawning new agentâ€¦ "
      eval `ssh-agent | tee ~/.ssh/agent.env`
      ssh-add
    fi
  else
    echo "Starting ssh-agent"
    eval `ssh-agent | tee ~/.ssh/agent.env`
    ssh-add
  fi
fi

